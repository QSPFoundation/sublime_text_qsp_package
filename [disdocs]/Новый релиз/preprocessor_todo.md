# Препроцессор

Решено переработать препроцессор, сделать его более "умным", а так же добавить в него возможность к расширению.

## Синтаксические правила

1. Спецкомментарии могут записываться, как отдельной строкой, так и после разделителя операторов `&`. Как обычные комментарии QSP.
2. Команды препроцессора (директивы) должны размещаться только на отдельных строках. Число пробелов до спецкомментария, как и в случае с недирективными спецкомментариями, не играет роли.
3. Директивы не работают внутри строк. (В старой версии препроцессора они работали и внутри строк, но в связи с выходом версии плеера 5.9.2, в которой был реализован функционал `setvar`, создавать код внутри строк больше нет необходимости)
4. Ошибки в директивах игнорируются, и такие директивы обрабатываются, как обычные спецкомментарии.
5. Вкладывать условия друг в друга нельзя (наверное, это только пока)

### Токены

- `!@` - спецкомментарий
- `!@<` - спецкомментарий с удалением строки кода
- `!@pp:` - директива препроцессора
	- `on` - включить препроцессинг
	- `off` - выключить препроцессинг
	- `savecomm` - сохранять спецкомментарии
	- `nosavecomm` - удалять спецкомментарии
	- `var` - объявить переменную (метку)
	- `nopp` - выключить препроцессор до конца файла
	- `if` - оператор условия
	- `:` - оператор `then`, т.е. что делать, если условие выполнено.
	- `endif` - оператор, завершающий условие
	- `or` - бинарный оператор ИЛИ
	- `and` - бинарный оператор И
	- `not` - бинарный оператор НЕ
	- `exclude` - исключить нижеследующее
	- `include` - включить нижеследующее
	- `(...)` - скобки для выделения операторов присваивания, сравнения и т.п.
	- `==` - сравнение на равенство
	- `!=` - сравнение на неравенство
	- `\w+` - имя переменной (метки)
	- `"..."` - строка (если распознано, директива не работает)
	- `'...'` - строка (если распознано, директива не работает)
	- `.+` - любой набор символов, кроме токенов (директива не работает)
- `"..."` - строка в кавычках
- `'...'` - строка в апострофах
- ??? `{...}` - open_brace, close_Brace